.project-page {
  $copy-size: 1.15em;
  $copy-line-height: 2em;

  .main {
    background-color: $white;

    section {
      padding: 3em 0;

      .container, .container-sm {
        @include pad();
      }
    }

    & > .container {
      text-align: center;
    }
  }

  .device-background {
    $base-border-radius: 3px !default;
    $action-color: #477DCA !default;
    $large-screen: em(860) !default;
    $device-padding-vertical: 5em;
    $device-padding-horizontal: 0.4em;
    $device-screen-width: 14em;
    $device-screen-height: 25em;
    $device-background: darken(gray, 40%);
    $device-backside-background: darken($device-background, 10%);
    $device-text-color: white;

    @include outer-container;

    background-repeat: no-repeat;
    background-size: cover;
    min-height: 20em;
    width: 100%;
    position: relative;

    .device-text {
      padding: 2em;

      @include media($screen-medium-up) {
        float: left;
        max-width: 50%;
        padding: 4em;
      }

      @include media($screen-large-up) {
        max-width: 65%;
      }

      h4 {
        border-bottom: 1px solid transparentize($device-text-color, 0.7);
        color: $device-text-color;
        font-size: 1.5em;
        margin: 0 0 0.5em 0;
        padding-bottom: 0.5em;
      }

      p {
        color: $device-text-color;
        line-height: 1.5em;
        margin-bottom: 1.5em;
      }
    }

    .device {
      position: relative;
      text-align: center;
      max-height: 60vh;
      overflow: hidden;
      padding: 1em;
      background-color: $white;
      $device-medium-translate-y: 3em;
      $device-large-translate-y: -4em;

      .screen {
        display: none;
      }

      @include media($screen-medium-up) {
        overflow: auto;
        max-height: none;
        @include transform(
          perspective(800px) 
          translateX(0px) 
          translateY($device-medium-translate-y) 
          translateZ(50px) 
          rotateX(0deg) 
          rotateY(-20deg) 
          rotateZ(-0deg));
        background-color: $device-background;
        border-radius: 2em;
        box-shadow: 
          1px 0px lighten($device-backside-background, 20%), 
          4px 0px lighten($device-backside-background, 2%),
          7px 0px $device-backside-background,
          10px 0px $device-backside-background,
          13px 0px $device-backside-background;
        display: block;
        float: right;
        margin-bottom: -12em;
        margin-right: 5em;
        padding: $device-padding-vertical 0;
        width: $device-screen-width + (2 * $device-padding-horizontal);

        img {
          display: none;
        }

        .screen {
          display: block;
          @include size($device-screen-width $device-screen-height);
          background-size: cover;
          border-radius: 0.2em;
          box-shadow: inset 0 1px 8px transparentize(black, 0.5);
          margin: auto;
        }
      }

      @include media($screen-large-up) {
        @include transform(
          perspective(800px) 
          translateX(0px) 
          translateY($device-large-translate-y) 
          translateZ(50px) 
          rotateX(0deg) 
          rotateY(-20deg) 
          rotateZ(-0deg));
      }
    }
  }

  .side-content {
    .container {
      background: $light-gray;
      display: flex;
      flex-direction: column;

      @include media($screen-medium-up) {
        flex-direction: row;
      }
    }

    .images-wrapper {
      // @include background(url('https://raw.githubusercontent.com/thoughtbot/refills/master/source/images/mountains.png'), linear-gradient($side-image-background-top, $side-image-background-bottom), no-repeat $side-image-background-top scroll);
      // background-color: $side-image-background-top;
      background-size: cover;
      border-bottom: $medium-gray;
      display: block;
      min-height: 12em;
      padding: 3em;

      @include media($screen-medium-up) {
        @include span-columns(4);
        background-position: bottom;
        background-size: cover;
        border-right: $medium-gray;
      }
    }

    .video-wrapper {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      overflow: hidden;

      @include media($screen-medium-up) {
        @include span-columns(5);
        display: flex;
        justify-content: flex-end;
        align-items: center;
      }
    }

    .image-wrapper {
      overflow: hidden;
      text-align: center;

      img {
        margin: 0 auto;
      }

      @include media($screen-medium-up) {
        @include span-columns(5);
        background: $white;

        img {
          display: block;
        }
      }
    }

    .side-content-copy {
      color: $dark-gray;
      font-size: $copy-size;
      line-height: $copy-line-height;
      @include pad();

      @include media($screen-medium-up) {
        @include span-columns(7);
        // padding: 4em 4em 8em 4em;
      }

      p {
        color: $dark-gray;
      }

      h1 {
        margin-bottom: 0.9em;
      }

      h4 {
        background: #BBB;
        color: white;
        display: inline-block;
        font-size: 0.75em;
        margin-bottom: 1.3em;
        padding: 3px 8px;
        text-transform: uppercase;
      }

      a {
        @include light-scheme-link();
      }
    }
  }

  .intro-image {
    text-align: center;

    .intro-image-wrap {
      display: inline-block;
      position: relative;
      max-height: 40vh;
      overflow: hidden;
      transition: max-height .6s $base-timing;
      cursor: pointer;

      &:after {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        display: block;
        content: '';
        @include background(linear-gradient(rgba($dark-gray, 0) 0%, rgba($dark-gray, 0) 55%, rgba($dark-gray, .2) 90%, rgba($dark-gray, .8) 100%), no-repeat);
        opacity: 1;
        transition: opacity .6s $base-timing;
      }

      &.expand {
        max-height: 200vh;

        &:after {
          opacity: 0;
        }
      }
    }

    & + section {
      padding-top: 2.5em;
    }
  }

  .dual-images {
    background: $light-gray;

    .middle-column {
      padding: 2em;
      color: $dark-gray;
      text-align: justify;
      font-size: $copy-size;
      line-height: $copy-line-height;
    }

    @include media($screen-medium-up) {
      display: flex;
      justify-content: top;

      img {
        display: block;
      }

      .img-wrapper {
        @include flex-basis(300px);
      }

      .middle-column {
        flex: 1;
      }
    }
  }

  &.project-tompham .intro-image {
    background-color: black;
  }

  &.project-morsel .device-background {
    background: #e96144;
  }

  &.project-tasting-collective .device-background {
    background: #444b52;
  }

  .badges {
    margin-bottom: 2em;

    @include media($screen-medium-up) {
      @include span-columns(4);
    }

    .badge {
      margin: .4em;
      font-size: 1em;
    }
  }

  .copy-wrapper {
    font-size: $copy-size;
    line-height: $copy-line-height;

    @include media($screen-medium-up) {
      @include span-columns(8);
    }
  }

  .copy {
    font-size: $copy-size;
    line-height: $copy-line-height;

    @include media($screen-medium-up) {
      @include span-columns(8);
      @include shift(2);
    }
  }

  .wide-image {
    img {
      display: block;
      margin: 0 auto;
      border: 1px solid $light-gray;
    }
  }

  .contact {
    padding-top: 6em;
  }

  video {
    display: block;
    max-width: 100%;
    margin: 0 auto;
  }
}